{"ast":null,"code":"import _objectSpread from\"D:/projects/BE_MAJOR_PROJECT_Krutik/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";/* client/src/App.js *//* eslint-disable react-hooks/exhaustive-deps */import React,{useEffect,useRef,useState}from\"react\";import{io}from\"socket.io-client\";import{SOCKET_URL,CV_API_URL}from\"./config\";// ✅ import from your new config file\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SIO=io(SOCKET_URL);// ✅ use SOCKET_URL instead of localhost\n// helpers: base64 <-> arraybuffer\nfunction b64ToArrayBuffer(b64){const binary=atob(b64);const len=binary.length;const bytes=new Uint8Array(len);for(let i=0;i<len;i++)bytes[i]=binary.charCodeAt(i);return bytes.buffer;}function arrayBufferToB64(buf){const bytes=new Uint8Array(buf);let bin=\"\";for(let i=0;i<bytes.byteLength;i++)bin+=String.fromCharCode(bytes[i]);return btoa(bin);}// ECDH (P-256) + AES-GCM helpers\nasync function generateECDHKeyPair(){const kp=await window.crypto.subtle.generateKey({name:\"ECDH\",namedCurve:\"P-256\"},true,[\"deriveKey\"]);const pubRaw=await window.crypto.subtle.exportKey(\"raw\",kp.publicKey);const pubB64=arrayBufferToB64(pubRaw);return{keyPair:kp,publicKeyB64:pubB64};}async function importPeerPublicKey(rawB64){const raw=b64ToArrayBuffer(rawB64);return window.crypto.subtle.importKey(\"raw\",raw,{name:\"ECDH\",namedCurve:\"P-256\"},true,[]);}async function deriveAESGCMKey(ownKP,peerRawB64){const peerKey=await importPeerPublicKey(peerRawB64);const aesKey=await window.crypto.subtle.deriveKey({name:\"ECDH\",public:peerKey},ownKP.privateKey,{name:\"AES-GCM\",length:256},false,[\"encrypt\",\"decrypt\"]);return aesKey;}async function encryptAesGcm(key,plaintext){const iv=window.crypto.getRandomValues(new Uint8Array(12));const enc=new TextEncoder().encode(plaintext);const ct=await window.crypto.subtle.encrypt({name:\"AES-GCM\",iv},key,enc);return{ciphertext:arrayBufferToB64(ct),iv:arrayBufferToB64(iv.buffer)};}async function decryptAesGcm(key,ciphertextB64,ivB64){const ivBuf=b64ToArrayBuffer(ivB64);const ctBuf=b64ToArrayBuffer(ciphertextB64);const plainBuf=await window.crypto.subtle.decrypt({name:\"AES-GCM\",iv:new Uint8Array(ivBuf)},key,ctBuf);return new TextDecoder().decode(plainBuf);}// ---------- AES helpers for detection decryption ----------\nasync function importDetectionKeyFromB64(b64){try{const raw=b64ToArrayBuffer(b64);const key=await window.crypto.subtle.importKey(\"raw\",raw,\"AES-GCM\",false,[\"decrypt\"]);return key;}catch(e){console.error(\"importDetectionKeyFromB64 failed\",e);return null;}}// ---------- App ----------\nexport default function App(){const videoRef=useRef(null);const overlayRef=useRef(null);const framesWSRef=useRef(null);const detectWSRef=useRef(null);const[username,setUsername]=useState(\"\");const[peer,setPeer]=useState(\"\");const[connected,setConnected]=useState(false);const[detections,setDetections]=useState([]);const[selected,setSelected]=useState(null);const localKeyPairRef=useRef(null);const localPubB64Ref=useRef(null);const[peerPubMap,setPeerPubMap]=useState({});const derivedKeysRef=useRef({});const detectionKeyRef=useRef(null);const[chats,setChats]=useState({});const[input,setInput]=useState(\"\");const FRAME_INTERVAL_MS=500;// Init local ECDH key pair\nuseEffect(()=>{(async()=>{const{keyPair,publicKeyB64}=await generateECDHKeyPair();localKeyPairRef.current=keyPair;localPubB64Ref.current=publicKeyB64;})();(async()=>{try{const res=await fetch(\"http://localhost:7001/static/detection_key.txt\");const key=await res.text();detectionKeyRef.current=await importDetectionKeyFromB64(key.trim());console.log(\"Detection AES key imported automatically.\");}catch(e){console.warn(\"Failed to fetch detection key\",e);}})();},[]);// Socket.IO handlers\nuseEffect(()=>{SIO.on(\"connect\",()=>setConnected(true));SIO.on(\"disconnect\",()=>setConnected(false));SIO.on(\"message\",async msg=>{const{sender,object_id,text_enc,ts}=msg;const aesKey=derivedKeysRef.current[sender];if(aesKey&&text_enc){try{const plaintext=await decryptAesGcm(aesKey,text_enc.ciphertext,text_enc.iv);setChats(prev=>{const arr=prev[object_id]?[...prev[object_id]]:[];arr.push({sender,plaintext,ts:ts||Date.now()});return _objectSpread(_objectSpread({},prev),{},{[object_id]:arr});});}catch(_unused){setChats(prev=>{const arr=prev[object_id]?[...prev[object_id]]:[];arr.push({sender,plaintext:\"[decryption_failed]\",ts:ts||Date.now()});return _objectSpread(_objectSpread({},prev),{},{[object_id]:arr});});}}else{setChats(prev=>{const arr=prev[object_id]?[...prev[object_id]]:[];arr.push({sender,plaintext:\"[encrypted]\",ts:ts||Date.now()});return _objectSpread(_objectSpread({},prev),{},{[object_id]:arr});});}});SIO.on(\"pubkey_response\",async _ref=>{let{peer,publicKeyB64}=_ref;if(!publicKeyB64){alert(\"Peer \\\"\".concat(peer,\"\\\" is not registered or has not published a key yet.\"));return;}setPeerPubMap(prev=>_objectSpread(_objectSpread({},prev),{},{[peer]:publicKeyB64}));if(localKeyPairRef.current){try{const aes=await deriveAESGCMKey(localKeyPairRef.current,publicKeyB64);derivedKeysRef.current[peer]=aes;SIO.emit(\"send_pubkey_to\",{from:username,to:peer,publicKeyB64:localPubB64Ref.current});alert(\"Shared key established with \".concat(peer));}catch(e){console.warn(\"derive failed\",e);}}});SIO.on(\"peer_pubkey\",async _ref2=>{let{from,publicKeyB64}=_ref2;setPeerPubMap(prev=>_objectSpread(_objectSpread({},prev),{},{[from]:publicKeyB64}));if(localKeyPairRef.current){try{const aes=await deriveAESGCMKey(localKeyPairRef.current,publicKeyB64);derivedKeysRef.current[from]=aes;console.log(\"Derived AES for\",from);}catch(e){console.warn(\"derive failed\",e);}}});return()=>{SIO.off(\"connect\");SIO.off(\"disconnect\");SIO.off(\"message\");SIO.off(\"pubkey_response\");SIO.off(\"peer_pubkey\");};},[]);async function handleRegister(){if(!username)return alert(\"Type a username first\");if(!localPubB64Ref.current){const{keyPair,publicKeyB64}=await generateECDHKeyPair();localKeyPairRef.current=keyPair;localPubB64Ref.current=publicKeyB64;}SIO.emit(\"register\",{username,publicKeyB64:localPubB64Ref.current});alert(\"Registered as \".concat(username));}async function establishSharedKeyWithPeer(){if(!peer)return alert(\"Set peer username\");SIO.emit(\"get_pubkey\",{requester:username,peer});}// Detection WS\nuseEffect(()=>{const DETECTION_WS=CV_API_URL.replace(/^http/,\"ws\")+\"/ws\";const ws=new WebSocket(DETECTION_WS);detectWSRef.current=ws;ws.onmessage=async evt=>{try{const data=JSON.parse(evt.data);if(data.type===\"detection_broadcast_enc\"&&data.data&&detectionKeyRef.current){const{ciphertext_b64,iv_b64}=data.data;const plainBuf=await window.crypto.subtle.decrypt({name:\"AES-GCM\",iv:new Uint8Array(b64ToArrayBuffer(iv_b64))},detectionKeyRef.current,b64ToArrayBuffer(ciphertext_b64));const obj=JSON.parse(new TextDecoder().decode(plainBuf));setDetections(obj.detections||[]);}else if(data.type===\"detection_broadcast\"&&data.detections){setDetections(data.detections||[]);}}catch(e){console.warn(\"Invalid detection data\",e);}};return()=>ws.close();},[]);// Frames WS\nuseEffect(()=>{let ws=null,interval=null,mounted=true;const startFramesWS=async()=>{try{const FRAMES_WS=CV_API_URL.replace(/^http/,\"ws\")+\"/ws_frames\";ws=new WebSocket(FRAMES_WS);framesWSRef.current=ws;const stream=await navigator.mediaDevices.getUserMedia({video:true});if(videoRef.current){videoRef.current.srcObject=stream;await videoRef.current.play();}interval=setInterval(()=>{if(!mounted||!videoRef.current||ws.readyState!==WebSocket.OPEN)return;const canvas=document.createElement(\"canvas\");canvas.width=320;canvas.height=240;const ctx=canvas.getContext(\"2d\");ctx.drawImage(videoRef.current,0,0,320,240);ws.send(canvas.toDataURL(\"image/jpeg\",0.7));},FRAME_INTERVAL_MS);}catch(e){console.error(\"frames WS setup failed\",e);}};startFramesWS();return()=>{mounted=false;if(interval)clearInterval(interval);if(framesWSRef.current)framesWSRef.current.close();if(videoRef.current&&videoRef.current.srcObject){videoRef.current.srcObject.getTracks().forEach(t=>t.stop());}};},[]);// Overlay rendering (boxes + messages above selected object)\nuseEffect(()=>{const canvas=overlayRef.current;const video=videoRef.current;if(!canvas||!video)return;const ctx=canvas.getContext(\"2d\");let raf;const render=()=>{const w=canvas.width=video.clientWidth||640;const h=canvas.height=video.clientHeight||480;ctx.clearRect(0,0,w,h);// Scale from 320x240 to video size\nconst sx=w/320,sy=h/240;for(const d of detections){const[x1,y1,x2,y2]=d.bbox;const left=x1*sx,top=y1*sy,width=(x2-x1)*sx,height=(y2-y1)*sy;ctx.lineWidth=selected===d.object_id?3:2;ctx.strokeStyle=selected===d.object_id?\"#34d399\":\"#f59e0b\";ctx.strokeRect(left,top,width,height);ctx.fillStyle=ctx.strokeStyle;ctx.font=\"14px Inter, Arial\";ctx.fillText(\"\".concat(d.class,\" \").concat((d.conf*100).toFixed(0),\"%\"),left+6,top+18);if(selected===d.object_id){const msgs=chats[selected]||[];const last=msgs.slice(-2);last.forEach((m,idx)=>{const text=m.plaintext||\"[encrypted]\";const bx=left,by=top-20*(last.length-idx);const wText=Math.min(300,ctx.measureText(text).width+12);ctx.fillStyle=\"rgba(2,6,23,0.9)\";ctx.fillRect(bx,by-14,wText,18);ctx.fillStyle=\"#e6eef8\";ctx.fillText(text,bx+6,by);});}}raf=requestAnimationFrame(render);};raf=requestAnimationFrame(render);return()=>cancelAnimationFrame(raf);},[detections,chats,selected]);// Click handler for selecting objects\nfunction handleVideoClick(e){const rect=e.target.getBoundingClientRect();const x=e.clientX-rect.left;const y=e.clientY-rect.top;const w=e.target.clientWidth||640;const h=e.target.clientHeight||480;const sx=320/w,sy=240/h;let picked=null;for(const d of detections){const[x1,y1,x2,y2]=d.bbox;// Map click to 320x240 space\nconst rx=x*sx,ry=y*sy;if(rx>=x1&&rx<=x2&&ry>=y1&&ry<=y2){picked=d.object_id;break;}}setSelected(picked);}async function sendMessage(){if(!username||!peer)return alert(\"set username and peer\");if(!selected)return alert(\"select an object first\");if(!input)return;const aesKey=derivedKeysRef.current[peer];if(!aesKey)return alert(\"no shared key with peer yet\");try{const enc=await encryptAesGcm(aesKey,input);SIO.emit(\"message\",{sender:username,receiver:peer,object_id:selected,text_enc:enc,ts:Date.now()});setChats(prev=>{const arr=prev[selected]?[...prev[selected]]:[];arr.push({sender:username,plaintext:input,ts:Date.now()});return _objectSpread(_objectSpread({},prev),{},{[selected]:arr});});setInput(\"\");}catch(e){console.error(\"send failed\",e);alert(\"Failed to send message\");}}// ---------- UI ----------\nreturn/*#__PURE__*/_jsxs(\"div\",{style:{fontFamily:\"'Inter', 'Poppins', Arial, sans-serif\",background:\"linear-gradient(135deg, #18181b 0%, #23272f 100%)\",minHeight:\"100vh\",color:\"#f4f4f5\",padding:24,letterSpacing:0.1},children:[/*#__PURE__*/_jsx(\"link\",{href:\"https://fonts.googleapis.com/css2?family=Inter:wght@500;700&display=swap\",rel:\"stylesheet\"}),/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:1300,margin:\"0 auto 32px\",display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",padding:\"0 8px\"},children:[/*#__PURE__*/_jsx(\"h2\",{style:{margin:0,fontWeight:700,fontSize:28,color:\"#fff\",letterSpacing:1,textShadow:\"0 2px 16px #000a\"},children:\"Real Time Messaging System Using AI/ML\"}),/*#__PURE__*/_jsx(\"div\",{style:{color:connected?\"#22d3ee\":\"#f87171\",fontWeight:600,fontSize:16,letterSpacing:1,background:connected?\"rgba(34,211,238,0.10)\":\"rgba(248,113,113,0.10)\",padding:\"6px 18px\",borderRadius:16,boxShadow:\"0 2px 12px 0 rgba(34,211,238,0.08)\"},children:connected?\"Online\":\"Offline\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"grid\",gridTemplateColumns:\"340px 1fr 370px\",gap:24,alignItems:\"flex-start\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:\"rgba(36,37,46,0.98)\",backdropFilter:\"blur(12px)\",borderRadius:18,boxShadow:\"0 4px 32px 0 rgba(34,211,238,0.10)\",padding:24,border:\"1.5px solid rgba(63,63,70,0.32)\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,marginBottom:14,fontSize:20,color:\"#22d3ee\"},children:\"Session\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:14,color:\"#a1a1aa\"},children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{style:{width:\"100%\",padding:12,marginTop:8,borderRadius:12,border:\"1.5px solid #22d3ee\",background:\"#23272f\",color:\"#22d3ee\",fontWeight:600,fontSize:16,outline:\"none\",marginBottom:12,transition:\"border 0.2s\"},value:username,onChange:e=>setUsername(e.target.value),placeholder:\"your name\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:14,color:\"#a1a1aa\"},children:\"Peer\"}),/*#__PURE__*/_jsx(\"input\",{style:{width:\"100%\",padding:12,marginTop:8,borderRadius:12,border:\"1.5px solid #818cf8\",background:\"#23272f\",color:\"#818cf8\",fontWeight:600,fontSize:16,outline:\"none\",marginBottom:16,transition:\"border 0.2s\"},value:peer,onChange:e=>setPeer(e.target.value),placeholder:\"peer username\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:10,marginTop:8},children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleRegister,disabled:!username||!localPubB64Ref.current,style:{padding:\"10px 18px\",borderRadius:12,background:\"linear-gradient(90deg, #22d3ee 60%, #818cf8 100%)\",border:\"none\",color:\"#fff\",fontWeight:700,fontSize:15,cursor:\"pointer\",boxShadow:\"0 2px 8px 0 rgba(34,211,238,0.10)\",letterSpacing:1,transition:\"background 0.2s\"},children:\"Register\"}),/*#__PURE__*/_jsx(\"button\",{onClick:establishSharedKeyWithPeer,disabled:!peer||!localPubB64Ref.current,style:{padding:\"10px 18px\",borderRadius:12,background:\"linear-gradient(90deg, #818cf8 60%, #22d3ee 100%)\",border:\"none\",color:\"#fff\",fontWeight:700,fontSize:15,cursor:\"pointer\",boxShadow:\"0 2px 8px 0 rgba(129,140,248,0.10)\",letterSpacing:1,transition:\"background 0.2s\"},children:\"Establish Key\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{height:18}}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:14,color:\"#a1a1aa\",marginBottom:8},children:\"Selected object\"}),/*#__PURE__*/_jsxs(\"div\",{style:{padding:12,background:\"rgba(34,211,238,0.10)\",borderRadius:12,color:\"#22d3ee\",fontWeight:700,fontSize:18,marginBottom:8,boxShadow:\"0 2px 8px 0 rgba(34,211,238,0.08)\"},children:[selected||\"None\",/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:12,color:\"#818cf8\",marginTop:4,fontWeight:500},children:[detections.length,\" objects in view\"]})]}),/*#__PURE__*/_jsx(\"div\",{style:{height:16}}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:14,color:\"#a1a1aa\"},children:\"Encrypted Message\"}),/*#__PURE__*/_jsx(\"textarea\",{value:input,onChange:e=>setInput(e.target.value),placeholder:\"Type message...\",rows:5,style:{width:\"100%\",marginTop:10,borderRadius:12,background:\"#23272f\",color:\"#818cf8\",border:\"1.5px solid #818cf8\",padding:12,fontSize:15,fontWeight:500,outline:\"none\",marginBottom:10,resize:\"vertical\"}}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:10,marginTop:8},children:[/*#__PURE__*/_jsx(\"button\",{onClick:sendMessage,style:{padding:\"10px 18px\",borderRadius:12,background:\"linear-gradient(90deg, #22d3ee 60%, #818cf8 100%)\",border:\"none\",color:\"#fff\",fontWeight:700,fontSize:15,cursor:\"pointer\",boxShadow:\"0 2px 8px 0 rgba(34,211,238,0.10)\",letterSpacing:1,transition:\"background 0.2s\"},children:\"Send\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setInput(\"\"),style:{padding:\"10px 18px\",borderRadius:12,background:\"linear-gradient(90deg, #818cf8 60%, #22d3ee 100%)\",border:\"none\",color:\"#fff\",fontWeight:700,fontSize:15,cursor:\"pointer\",boxShadow:\"0 2px 8px 0 rgba(129,140,248,0.10)\",letterSpacing:1,transition:\"background 0.2s\"},children:\"Clear\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{height:18}}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:14,color:\"#a1a1aa\"},children:\"Known peer public keys\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:10,maxHeight:160,overflowY:\"auto\",background:\"#23272f\",padding:10,borderRadius:12,fontSize:13,color:\"#f4f4f5\",boxShadow:\"0 2px 8px 0 rgba(34,211,238,0.08)\"},children:[Object.keys(peerPubMap).length===0&&/*#__PURE__*/_jsx(\"div\",{style:{color:\"#818cf8\"},children:\"No peer public keys yet\"}),Object.entries(peerPubMap).map(_ref3=>{let[u,k]=_ref3;return/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:10},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,color:\"#818cf8\"},children:u}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:12,color:\"#a1a1aa\",wordBreak:\"break-all\"},children:[k.slice(0,60),k.length>60?\"...\":\"\"]})]},u);})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:\"rgba(36,37,46,0.98)\",backdropFilter:\"blur(12px)\",borderRadius:18,boxShadow:\"0 4px 32px 0 rgba(34,211,238,0.10)\",padding:24,border:\"1.5px solid rgba(63,63,70,0.32)\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,marginBottom:14,fontSize:20,color:\"#22d3ee\"},children:\"Live Camera\"}),/*#__PURE__*/_jsxs(\"div\",{style:{width:\"100%\",position:\"relative\",background:\"#18181b\",borderRadius:14,overflow:\"hidden\",boxShadow:\"0 2px 16px 0 rgba(34,211,238,0.10)\"},children:[/*#__PURE__*/_jsx(\"video\",{ref:videoRef,onClick:handleVideoClick,style:{width:\"100%\",height:480,objectFit:\"cover\",borderRadius:14,filter:\"brightness(1.08) saturate(1.1)\"},autoPlay:true,muted:true}),/*#__PURE__*/_jsx(\"canvas\",{ref:overlayRef,style:{position:\"absolute\",left:0,top:0,pointerEvents:\"none\",zIndex:2}})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:14,display:\"flex\",gap:8},children:/*#__PURE__*/_jsx(\"div\",{style:{fontSize:15,color:\"#a1a1aa\",fontWeight:500},children:\"Tip: click a bounding box to select object\"})})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:\"rgba(36,37,46,0.98)\",backdropFilter:\"blur(12px)\",borderRadius:18,boxShadow:\"0 4px 32px 0 rgba(129,140,248,0.10)\",padding:24,border:\"1.5px solid rgba(63,63,70,0.32)\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,marginBottom:14,fontSize:20,color:\"#818cf8\"},children:\"Object Chat\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:15,color:\"#a1a1aa\",marginBottom:10,fontWeight:500},children:\"Messages for selected object\"}),/*#__PURE__*/_jsx(\"div\",{style:{maxHeight:480,overflowY:\"auto\",paddingRight:8},children:selected&&chats[selected]?chats[selected].map((m,i)=>/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",flexDirection:m.sender===username?\"row-reverse\":\"row\",marginBottom:14},children:/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:\"80%\",background:m.sender===username?\"linear-gradient(90deg, #22d3ee 60%, #818cf8 100%)\":\"#23272f\",color:m.sender===username?\"#fff\":\"#818cf8\",padding:14,borderRadius:16,fontWeight:600,fontSize:15,boxShadow:m.sender===username?\"0 2px 8px 0 rgba(34,211,238,0.10)\":\"0 2px 8px 0 rgba(129,140,248,0.10)\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:15,fontWeight:700},children:m.plaintext||\"[encrypted]\"}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:11,color:\"#a1a1aa\",marginTop:8},children:[m.sender,\" \\u2022 \",new Date(m.ts||Date.now()).toLocaleTimeString()]})]})},i)):/*#__PURE__*/_jsx(\"div\",{style:{color:\"#818cf8\"},children:\"Select an object to see messages\"})})]})]})]});}","map":{"version":3,"names":["React","useEffect","useRef","useState","io","SOCKET_URL","CV_API_URL","jsx","_jsx","jsxs","_jsxs","SIO","b64ToArrayBuffer","b64","binary","atob","len","length","bytes","Uint8Array","i","charCodeAt","buffer","arrayBufferToB64","buf","bin","byteLength","String","fromCharCode","btoa","generateECDHKeyPair","kp","window","crypto","subtle","generateKey","name","namedCurve","pubRaw","exportKey","publicKey","pubB64","keyPair","publicKeyB64","importPeerPublicKey","rawB64","raw","importKey","deriveAESGCMKey","ownKP","peerRawB64","peerKey","aesKey","deriveKey","public","privateKey","encryptAesGcm","key","plaintext","iv","getRandomValues","enc","TextEncoder","encode","ct","encrypt","ciphertext","decryptAesGcm","ciphertextB64","ivB64","ivBuf","ctBuf","plainBuf","decrypt","TextDecoder","decode","importDetectionKeyFromB64","e","console","error","App","videoRef","overlayRef","framesWSRef","detectWSRef","username","setUsername","peer","setPeer","connected","setConnected","detections","setDetections","selected","setSelected","localKeyPairRef","localPubB64Ref","peerPubMap","setPeerPubMap","derivedKeysRef","detectionKeyRef","chats","setChats","input","setInput","FRAME_INTERVAL_MS","current","res","fetch","text","trim","log","warn","on","msg","sender","object_id","text_enc","ts","prev","arr","push","Date","now","_objectSpread","_unused","_ref","alert","concat","aes","emit","from","to","_ref2","off","handleRegister","establishSharedKeyWithPeer","requester","DETECTION_WS","replace","ws","WebSocket","onmessage","evt","data","JSON","parse","type","ciphertext_b64","iv_b64","obj","close","interval","mounted","startFramesWS","FRAMES_WS","stream","navigator","mediaDevices","getUserMedia","video","srcObject","play","setInterval","readyState","OPEN","canvas","document","createElement","width","height","ctx","getContext","drawImage","send","toDataURL","clearInterval","getTracks","forEach","t","stop","raf","render","w","clientWidth","h","clientHeight","clearRect","sx","sy","d","x1","y1","x2","y2","bbox","left","top","lineWidth","strokeStyle","strokeRect","fillStyle","font","fillText","class","conf","toFixed","msgs","last","slice","m","idx","bx","by","wText","Math","min","measureText","fillRect","requestAnimationFrame","cancelAnimationFrame","handleVideoClick","rect","target","getBoundingClientRect","x","clientX","y","clientY","picked","rx","ry","sendMessage","receiver","style","fontFamily","background","minHeight","color","padding","letterSpacing","children","href","rel","maxWidth","margin","display","justifyContent","alignItems","fontWeight","fontSize","textShadow","borderRadius","boxShadow","gridTemplateColumns","gap","backdropFilter","border","marginBottom","marginTop","outline","transition","value","onChange","placeholder","onClick","disabled","cursor","rows","resize","maxHeight","overflowY","Object","keys","entries","map","_ref3","u","k","wordBreak","position","overflow","ref","objectFit","filter","autoPlay","muted","pointerEvents","zIndex","paddingRight","flexDirection","toLocaleTimeString"],"sources":["D:/projects/BE_MAJOR_PROJECT_Krutik/client/src/App.js"],"sourcesContent":["/* client/src/App.js */\n/* eslint-disable react-hooks/exhaustive-deps */\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { io } from \"socket.io-client\";\nimport { SOCKET_URL, CV_API_URL } from \"./config\"; // ✅ import from your new config file\n\nconst SIO = io(SOCKET_URL); // ✅ use SOCKET_URL instead of localhost\n\n// helpers: base64 <-> arraybuffer\nfunction b64ToArrayBuffer(b64) {\n  const binary = atob(b64);\n  const len = binary.length;\n  const bytes = new Uint8Array(len);\n  for (let i = 0; i < len; i++) bytes[i] = binary.charCodeAt(i);\n  return bytes.buffer;\n}\nfunction arrayBufferToB64(buf) {\n  const bytes = new Uint8Array(buf);\n  let bin = \"\";\n  for (let i = 0; i < bytes.byteLength; i++) bin += String.fromCharCode(bytes[i]);\n  return btoa(bin);\n}\n\n// ECDH (P-256) + AES-GCM helpers\nasync function generateECDHKeyPair() {\n  const kp = await window.crypto.subtle.generateKey(\n    { name: \"ECDH\", namedCurve: \"P-256\" },\n    true,\n    [\"deriveKey\"]\n  );\n  const pubRaw = await window.crypto.subtle.exportKey(\"raw\", kp.publicKey);\n  const pubB64 = arrayBufferToB64(pubRaw);\n  return { keyPair: kp, publicKeyB64: pubB64 };\n}\nasync function importPeerPublicKey(rawB64) {\n  const raw = b64ToArrayBuffer(rawB64);\n  return window.crypto.subtle.importKey(\"raw\", raw, { name: \"ECDH\", namedCurve: \"P-256\" }, true, []);\n}\nasync function deriveAESGCMKey(ownKP, peerRawB64) {\n  const peerKey = await importPeerPublicKey(peerRawB64);\n  const aesKey = await window.crypto.subtle.deriveKey(\n    { name: \"ECDH\", public: peerKey },\n    ownKP.privateKey,\n    { name: \"AES-GCM\", length: 256 },\n    false,\n    [\"encrypt\", \"decrypt\"]\n  );\n  return aesKey;\n}\nasync function encryptAesGcm(key, plaintext) {\n  const iv = window.crypto.getRandomValues(new Uint8Array(12));\n  const enc = new TextEncoder().encode(plaintext);\n  const ct = await window.crypto.subtle.encrypt({ name: \"AES-GCM\", iv }, key, enc);\n  return { ciphertext: arrayBufferToB64(ct), iv: arrayBufferToB64(iv.buffer) };\n}\nasync function decryptAesGcm(key, ciphertextB64, ivB64) {\n  const ivBuf = b64ToArrayBuffer(ivB64);\n  const ctBuf = b64ToArrayBuffer(ciphertextB64);\n  const plainBuf = await window.crypto.subtle.decrypt({ name: \"AES-GCM\", iv: new Uint8Array(ivBuf) }, key, ctBuf);\n  return new TextDecoder().decode(plainBuf);\n}\n\n// ---------- AES helpers for detection decryption ----------\nasync function importDetectionKeyFromB64(b64) {\n  try {\n    const raw = b64ToArrayBuffer(b64);\n    const key = await window.crypto.subtle.importKey(\"raw\", raw, \"AES-GCM\", false, [\"decrypt\"]);\n    return key;\n  } catch (e) {\n    console.error(\"importDetectionKeyFromB64 failed\", e);\n    return null;\n  }\n}\n\n// ---------- App ----------\nexport default function App() {\n  const videoRef = useRef(null);\n  const overlayRef = useRef(null);\n  const framesWSRef = useRef(null);\n  const detectWSRef = useRef(null);\n\n  const [username, setUsername] = useState(\"\");\n  const [peer, setPeer] = useState(\"\");\n  const [connected, setConnected] = useState(false);\n\n  const [detections, setDetections] = useState([]);\n  const [selected, setSelected] = useState(null);\n\n  const localKeyPairRef = useRef(null);\n  const localPubB64Ref = useRef(null);\n  const [peerPubMap, setPeerPubMap] = useState({});\n  const derivedKeysRef = useRef({});\n\n  const detectionKeyRef = useRef(null);\n\n  const [chats, setChats] = useState({});\n  const [input, setInput] = useState(\"\");\n\n  const FRAME_INTERVAL_MS = 500;\n\n  // Init local ECDH key pair\n  useEffect(() => {\n    (async () => {\n      const { keyPair, publicKeyB64 } = await generateECDHKeyPair();\n      localKeyPairRef.current = keyPair;\n      localPubB64Ref.current = publicKeyB64;\n    })();\n\n    (async () => {\n      try {\n        const res = await fetch(\"http://localhost:7001/static/detection_key.txt\");\n        const key = await res.text();\n        detectionKeyRef.current = await importDetectionKeyFromB64(key.trim());\n        console.log(\"Detection AES key imported automatically.\");\n      } catch (e) {\n        console.warn(\"Failed to fetch detection key\", e);\n      }\n    })();\n  }, []);\n\n  // Socket.IO handlers\n  useEffect(() => {\n    SIO.on(\"connect\", () => setConnected(true));\n    SIO.on(\"disconnect\", () => setConnected(false));\n\n    SIO.on(\"message\", async (msg) => {\n      const { sender, object_id, text_enc, ts } = msg;\n      const aesKey = derivedKeysRef.current[sender];\n      if (aesKey && text_enc) {\n        try {\n          const plaintext = await decryptAesGcm(aesKey, text_enc.ciphertext, text_enc.iv);\n          setChats(prev => {\n            const arr = prev[object_id] ? [...prev[object_id]] : [];\n            arr.push({ sender, plaintext, ts: ts || Date.now() });\n            return { ...prev, [object_id]: arr };\n          });\n        } catch {\n          setChats(prev => {\n            const arr = prev[object_id] ? [...prev[object_id]] : [];\n            arr.push({ sender, plaintext: \"[decryption_failed]\", ts: ts || Date.now() });\n            return { ...prev, [object_id]: arr };\n          });\n        }\n      } else {\n        setChats(prev => {\n          const arr = prev[object_id] ? [...prev[object_id]] : [];\n          arr.push({ sender, plaintext: \"[encrypted]\", ts: ts || Date.now() });\n          return { ...prev, [object_id]: arr };\n        });\n      }\n    });\n\n    SIO.on(\"pubkey_response\", async ({ peer, publicKeyB64 }) => {\n      if (!publicKeyB64) {\n        alert(`Peer \"${peer}\" is not registered or has not published a key yet.`);\n        return;\n      }\n      setPeerPubMap(prev => ({ ...prev, [peer]: publicKeyB64 }));\n      if (localKeyPairRef.current) {\n        try {\n          const aes = await deriveAESGCMKey(localKeyPairRef.current, publicKeyB64);\n          derivedKeysRef.current[peer] = aes;\n          SIO.emit(\"send_pubkey_to\", { from: username, to: peer, publicKeyB64: localPubB64Ref.current });\n          alert(`Shared key established with ${peer}`);\n        } catch (e) {\n          console.warn(\"derive failed\", e);\n        }\n      }\n    });\n\n    SIO.on(\"peer_pubkey\", async ({ from, publicKeyB64 }) => {\n      setPeerPubMap(prev => ({ ...prev, [from]: publicKeyB64 }));\n      if (localKeyPairRef.current) {\n        try {\n          const aes = await deriveAESGCMKey(localKeyPairRef.current, publicKeyB64);\n          derivedKeysRef.current[from] = aes;\n          console.log(\"Derived AES for\", from);\n        } catch (e) {\n          console.warn(\"derive failed\", e);\n        }\n      }\n    });\n\n    return () => {\n      SIO.off(\"connect\"); SIO.off(\"disconnect\"); SIO.off(\"message\"); SIO.off(\"pubkey_response\"); SIO.off(\"peer_pubkey\");\n    };\n  }, []);\n\n  async function handleRegister() {\n    if (!username) return alert(\"Type a username first\");\n    if (!localPubB64Ref.current) {\n      const { keyPair, publicKeyB64 } = await generateECDHKeyPair();\n      localKeyPairRef.current = keyPair;\n      localPubB64Ref.current = publicKeyB64;\n    }\n    SIO.emit(\"register\", { username, publicKeyB64: localPubB64Ref.current });\n    alert(`Registered as ${username}`);\n  }\n\n  async function establishSharedKeyWithPeer() {\n    if (!peer) return alert(\"Set peer username\");\n    SIO.emit(\"get_pubkey\", { requester: username, peer });\n  }\n\n  // Detection WS\n  useEffect(() => {\n    const DETECTION_WS = CV_API_URL.replace(/^http/, \"ws\") + \"/ws\";\n    const ws = new WebSocket(DETECTION_WS);\n    detectWSRef.current = ws;\n    ws.onmessage = async (evt) => {\n      try {\n        const data = JSON.parse(evt.data);\n        if (data.type === \"detection_broadcast_enc\" && data.data && detectionKeyRef.current) {\n          const { ciphertext_b64, iv_b64 } = data.data;\n          const plainBuf = await window.crypto.subtle.decrypt(\n            { name: \"AES-GCM\", iv: new Uint8Array(b64ToArrayBuffer(iv_b64)) },\n            detectionKeyRef.current,\n            b64ToArrayBuffer(ciphertext_b64)\n          );\n          const obj = JSON.parse(new TextDecoder().decode(plainBuf));\n          setDetections(obj.detections || []);\n        } else if (data.type === \"detection_broadcast\" && data.detections) {\n          setDetections(data.detections || []);\n        }\n      } catch (e) {\n        console.warn(\"Invalid detection data\", e);\n      }\n    };\n    return () => ws.close();\n  }, []);\n\n  // Frames WS\n  useEffect(() => {\n    let ws = null, interval = null, mounted = true;\n    const startFramesWS = async () => {\n      try {\n        const FRAMES_WS = CV_API_URL.replace(/^http/, \"ws\") + \"/ws_frames\";\n        ws = new WebSocket(FRAMES_WS);\n        framesWSRef.current = ws;\n        const stream = await navigator.mediaDevices.getUserMedia({ video: true });\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n          await videoRef.current.play();\n        }\n        interval = setInterval(() => {\n          if (!mounted || !videoRef.current || ws.readyState !== WebSocket.OPEN) return;\n          const canvas = document.createElement(\"canvas\");\n          canvas.width = 320; canvas.height = 240;\n          const ctx = canvas.getContext(\"2d\");\n          ctx.drawImage(videoRef.current, 0, 0, 320, 240);\n          ws.send(canvas.toDataURL(\"image/jpeg\", 0.7));\n        }, FRAME_INTERVAL_MS);\n      } catch (e) { console.error(\"frames WS setup failed\", e); }\n    };\n    startFramesWS();\n    return () => {\n      mounted = false;\n      if (interval) clearInterval(interval);\n      if (framesWSRef.current) framesWSRef.current.close();\n      if (videoRef.current && videoRef.current.srcObject) {\n        videoRef.current.srcObject.getTracks().forEach(t => t.stop());\n      }\n    };\n  }, []);\n\n  // Overlay rendering (boxes + messages above selected object)\n  useEffect(() => {\n    const canvas = overlayRef.current;\n    const video = videoRef.current;\n    if (!canvas || !video) return;\n    const ctx = canvas.getContext(\"2d\");\n    let raf;\n    const render = () => {\n      const w = canvas.width = video.clientWidth || 640;\n      const h = canvas.height = video.clientHeight || 480;\n      ctx.clearRect(0,0,w,h);\n\n      // Scale from 320x240 to video size\n      const sx = w / 320, sy = h / 240;\n\n      for (const d of detections) {\n        const [x1,y1,x2,y2] = d.bbox;\n        const left = x1*sx, top = y1*sy, width = (x2-x1)*sx, height = (y2-y1)*sy;\n        ctx.lineWidth = selected===d.object_id?3:2;\n        ctx.strokeStyle = selected===d.object_id?\"#34d399\":\"#f59e0b\";\n        ctx.strokeRect(left,top,width,height);\n        ctx.fillStyle=ctx.strokeStyle;\n        ctx.font=\"14px Inter, Arial\";\n        ctx.fillText(`${d.class} ${(d.conf*100).toFixed(0)}%`, left+6, top+18);\n\n        if(selected===d.object_id){\n          const msgs = chats[selected]||[];\n          const last = msgs.slice(-2);\n          last.forEach((m, idx)=>{\n            const text = m.plaintext || \"[encrypted]\";\n            const bx = left, by = top-20*(last.length-idx);\n            const wText = Math.min(300, ctx.measureText(text).width + 12);\n            ctx.fillStyle = \"rgba(2,6,23,0.9)\";\n            ctx.fillRect(bx, by-14, wText, 18);\n            ctx.fillStyle=\"#e6eef8\";\n            ctx.fillText(text, bx+6, by);\n          });\n        }\n      }\n\n      raf = requestAnimationFrame(render);\n    };\n    raf = requestAnimationFrame(render);\n    return ()=>cancelAnimationFrame(raf);\n  }, [detections, chats, selected]);\n\n  // Click handler for selecting objects\n  function handleVideoClick(e){\n    const rect = e.target.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    const y = e.clientY - rect.top;\n    const w = e.target.clientWidth || 640;\n    const h = e.target.clientHeight || 480;\n    const sx = 320 / w, sy = 240 / h;\n    let picked = null;\n    for(const d of detections){\n      const [x1,y1,x2,y2] = d.bbox;\n      // Map click to 320x240 space\n      const rx = x * sx, ry = y * sy;\n      if(rx>=x1 && rx<=x2 && ry>=y1 && ry<=y2){ picked=d.object_id; break; }\n    }\n    setSelected(picked);\n  }\n\n  async function sendMessage(){\n    if(!username||!peer) return alert(\"set username and peer\");\n    if(!selected) return alert(\"select an object first\");\n    if(!input) return;\n    const aesKey = derivedKeysRef.current[peer];\n    if(!aesKey) return alert(\"no shared key with peer yet\");\n    try{\n      const enc = await encryptAesGcm(aesKey, input);\n      SIO.emit(\"message\", { sender: username, receiver: peer, object_id: selected, text_enc: enc, ts:Date.now() });\n      setChats(prev=>{\n        const arr = prev[selected]? [...prev[selected]]:[];\n        arr.push({ sender:username, plaintext:input, ts:Date.now() });\n        return {...prev, [selected]:arr};\n      });\n      setInput(\"\");\n    } catch(e){ console.error(\"send failed\", e); alert(\"Failed to send message\"); }\n  }\n\n  // ---------- UI ----------\n  return (\n    <div\n      style={{\n        fontFamily: \"'Inter', 'Poppins', Arial, sans-serif\",\n        background: \"linear-gradient(135deg, #18181b 0%, #23272f 100%)\",\n        minHeight: \"100vh\",\n        color: \"#f4f4f5\",\n        padding: 24,\n        letterSpacing: 0.1,\n      }}\n    >\n      <link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@500;700&display=swap\" rel=\"stylesheet\" />\n      <div\n        style={{\n          maxWidth: 1300,\n          margin: \"0 auto 32px\",\n          display: \"flex\",\n          justifyContent: \"space-between\",\n          alignItems: \"center\",\n          padding: \"0 8px\",\n        }}\n      >\n        <h2\n          style={{\n            margin: 0,\n            fontWeight: 700,\n            fontSize: 28,\n            color: \"#fff\",\n            letterSpacing: 1,\n            textShadow: \"0 2px 16px #000a\",\n          }}\n        >\n          Real Time Messaging System Using AI/ML\n        </h2>\n        <div\n          style={{\n            color: connected ? \"#22d3ee\" : \"#f87171\",\n            fontWeight: 600,\n            fontSize: 16,\n            letterSpacing: 1,\n            background: connected\n              ? \"rgba(34,211,238,0.10)\"\n              : \"rgba(248,113,113,0.10)\",\n            padding: \"6px 18px\",\n            borderRadius: 16,\n            boxShadow: \"0 2px 12px 0 rgba(34,211,238,0.08)\",\n          }}\n        >\n          {connected ? \"Online\" : \"Offline\"}\n        </div>\n      </div>\n\n      <div\n        style={{\n          display: \"grid\",\n          gridTemplateColumns: \"340px 1fr 370px\",\n          gap: 24,\n          alignItems: \"flex-start\",\n        }}\n      >\n        {/* Session / controls */}\n        <div\n          style={{\n            background: \"rgba(36,37,46,0.98)\",\n            backdropFilter: \"blur(12px)\",\n            borderRadius: 18,\n            boxShadow: \"0 4px 32px 0 rgba(34,211,238,0.10)\",\n            padding: 24,\n            border: \"1.5px solid rgba(63,63,70,0.32)\",\n          }}\n        >\n          <div style={{ fontWeight: 700, marginBottom: 14, fontSize: 20, color: \"#22d3ee\" }}>Session</div>\n          <div style={{ fontSize: 14, color: \"#a1a1aa\" }}>Username</div>\n          <input\n            style={{\n              width: \"100%\",\n              padding: 12,\n              marginTop: 8,\n              borderRadius: 12,\n              border: \"1.5px solid #22d3ee\",\n              background: \"#23272f\",\n              color: \"#22d3ee\",\n              fontWeight: 600,\n              fontSize: 16,\n              outline: \"none\",\n              marginBottom: 12,\n              transition: \"border 0.2s\",\n            }}\n            value={username}\n            onChange={e => setUsername(e.target.value)}\n            placeholder=\"your name\"\n          />\n          <div style={{ fontSize: 14, color: \"#a1a1aa\" }}>Peer</div>\n          <input\n            style={{\n              width: \"100%\",\n              padding: 12,\n              marginTop: 8,\n              borderRadius: 12,\n              border: \"1.5px solid #818cf8\",\n              background: \"#23272f\",\n              color: \"#818cf8\",\n              fontWeight: 600,\n              fontSize: 16,\n              outline: \"none\",\n              marginBottom: 16,\n              transition: \"border 0.2s\",\n            }}\n            value={peer}\n            onChange={e => setPeer(e.target.value)}\n            placeholder=\"peer username\"\n          />\n          <div style={{ display: \"flex\", gap: 10, marginTop: 8 }}>\n            <button\n              onClick={handleRegister}\n              disabled={!username || !localPubB64Ref.current}\n              style={{\n                padding: \"10px 18px\",\n                borderRadius: 12,\n                background: \"linear-gradient(90deg, #22d3ee 60%, #818cf8 100%)\",\n                border: \"none\",\n                color: \"#fff\",\n                fontWeight: 700,\n                fontSize: 15,\n                cursor: \"pointer\",\n                boxShadow: \"0 2px 8px 0 rgba(34,211,238,0.10)\",\n                letterSpacing: 1,\n                transition: \"background 0.2s\",\n              }}\n            >\n              Register\n            </button>\n            <button\n              onClick={establishSharedKeyWithPeer}\n              disabled={!peer || !localPubB64Ref.current}\n              style={{\n                padding: \"10px 18px\",\n                borderRadius: 12,\n                background: \"linear-gradient(90deg, #818cf8 60%, #22d3ee 100%)\",\n                border: \"none\",\n                color: \"#fff\",\n                fontWeight: 700,\n                fontSize: 15,\n                cursor: \"pointer\",\n                boxShadow: \"0 2px 8px 0 rgba(129,140,248,0.10)\",\n                letterSpacing: 1,\n                transition: \"background 0.2s\",\n              }}\n            >\n              Establish Key\n            </button>\n          </div>\n\n          <div style={{ height: 18 }} />\n          <div style={{ fontSize: 14, color: \"#a1a1aa\", marginBottom: 8 }}>Selected object</div>\n          <div\n            style={{\n              padding: 12,\n              background: \"rgba(34,211,238,0.10)\",\n              borderRadius: 12,\n              color: \"#22d3ee\",\n              fontWeight: 700,\n              fontSize: 18,\n              marginBottom: 8,\n              boxShadow: \"0 2px 8px 0 rgba(34,211,238,0.08)\",\n            }}\n          >\n            {selected || \"None\"}\n            <div style={{ fontSize: 12, color: \"#818cf8\", marginTop: 4, fontWeight: 500 }}>\n              {detections.length} objects in view\n            </div>\n          </div>\n\n          <div style={{ height: 16 }} />\n          <div style={{ fontSize: 14, color: \"#a1a1aa\" }}>Encrypted Message</div>\n          <textarea\n            value={input}\n            onChange={e => setInput(e.target.value)}\n            placeholder=\"Type message...\"\n            rows={5}\n            style={{\n              width: \"100%\",\n              marginTop: 10,\n              borderRadius: 12,\n              background: \"#23272f\",\n              color: \"#818cf8\",\n              border: \"1.5px solid #818cf8\",\n              padding: 12,\n              fontSize: 15,\n              fontWeight: 500,\n              outline: \"none\",\n              marginBottom: 10,\n              resize: \"vertical\",\n            }}\n          />\n          <div style={{ display: \"flex\", gap: 10, marginTop: 8 }}>\n            <button\n              onClick={sendMessage}\n              style={{\n                padding: \"10px 18px\",\n                borderRadius: 12,\n                background: \"linear-gradient(90deg, #22d3ee 60%, #818cf8 100%)\",\n                border: \"none\",\n                color: \"#fff\",\n                fontWeight: 700,\n                fontSize: 15,\n                cursor: \"pointer\",\n                boxShadow: \"0 2px 8px 0 rgba(34,211,238,0.10)\",\n                letterSpacing: 1,\n                transition: \"background 0.2s\",\n              }}\n            >\n              Send\n            </button>\n            <button\n              onClick={() => setInput(\"\")}\n              style={{\n                padding: \"10px 18px\",\n                borderRadius: 12,\n                background: \"linear-gradient(90deg, #818cf8 60%, #22d3ee 100%)\",\n                border: \"none\",\n                color: \"#fff\",\n                fontWeight: 700,\n                fontSize: 15,\n                cursor: \"pointer\",\n                boxShadow: \"0 2px 8px 0 rgba(129,140,248,0.10)\",\n                letterSpacing: 1,\n                transition: \"background 0.2s\",\n              }}\n            >\n              Clear\n            </button>\n          </div>\n\n          <div style={{ height: 18 }} />\n          <div style={{ fontSize: 14, color: \"#a1a1aa\" }}>Known peer public keys</div>\n          <div\n            style={{\n              marginTop: 10,\n              maxHeight: 160,\n              overflowY: \"auto\",\n              background: \"#23272f\",\n              padding: 10,\n              borderRadius: 12,\n              fontSize: 13,\n              color: \"#f4f4f5\",\n              boxShadow: \"0 2px 8px 0 rgba(34,211,238,0.08)\",\n            }}\n          >\n            {Object.keys(peerPubMap).length === 0 && (\n              <div style={{ color: \"#818cf8\" }}>No peer public keys yet</div>\n            )}\n            {Object.entries(peerPubMap).map(([u, k]) => (\n              <div key={u} style={{ marginBottom: 10 }}>\n                <div style={{ fontWeight: 700, color: \"#818cf8\" }}>{u}</div>\n                <div style={{ fontSize: 12, color: \"#a1a1aa\", wordBreak: \"break-all\" }}>\n                  {k.slice(0, 60)}\n                  {k.length > 60 ? \"...\" : \"\"}\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n\n        {/* Video */}\n        <div\n          style={{\n            background: \"rgba(36,37,46,0.98)\",\n            backdropFilter: \"blur(12px)\",\n            borderRadius: 18,\n            boxShadow: \"0 4px 32px 0 rgba(34,211,238,0.10)\",\n            padding: 24,\n            border: \"1.5px solid rgba(63,63,70,0.32)\",\n          }}\n        >\n          <div style={{ fontWeight: 700, marginBottom: 14, fontSize: 20, color: \"#22d3ee\" }}>Live Camera</div>\n          <div\n            style={{\n              width: \"100%\",\n              position: \"relative\",\n              background: \"#18181b\",\n              borderRadius: 14,\n              overflow: \"hidden\",\n              boxShadow: \"0 2px 16px 0 rgba(34,211,238,0.10)\",\n            }}\n          >\n            <video\n              ref={videoRef}\n              onClick={handleVideoClick}\n              style={{\n                width: \"100%\",\n                height: 480,\n                objectFit: \"cover\",\n                borderRadius: 14,\n                filter: \"brightness(1.08) saturate(1.1)\",\n              }}\n              autoPlay\n              muted\n            />\n            <canvas\n              ref={overlayRef}\n              style={{\n                position: \"absolute\",\n                left: 0,\n                top: 0,\n                pointerEvents: \"none\",\n                zIndex: 2,\n              }}\n            />\n          </div>\n          <div style={{ marginTop: 14, display: \"flex\", gap: 8 }}>\n            <div style={{ fontSize: 15, color: \"#a1a1aa\", fontWeight: 500 }}>\n              Tip: click a bounding box to select object\n            </div>\n          </div>\n        </div>\n\n        {/* Chat Sidebar */}\n        <div\n          style={{\n            background: \"rgba(36,37,46,0.98)\",\n            backdropFilter: \"blur(12px)\",\n            borderRadius: 18,\n            boxShadow: \"0 4px 32px 0 rgba(129,140,248,0.10)\",\n            padding: 24,\n            border: \"1.5px solid rgba(63,63,70,0.32)\",\n          }}\n        >\n          <div style={{ fontWeight: 700, marginBottom: 14, fontSize: 20, color: \"#818cf8\" }}>Object Chat</div>\n          <div style={{ fontSize: 15, color: \"#a1a1aa\", marginBottom: 10, fontWeight: 500 }}>\n            Messages for selected object\n          </div>\n          <div style={{ maxHeight: 480, overflowY: \"auto\", paddingRight: 8 }}>\n            {selected && chats[selected] ? (\n              chats[selected].map((m, i) => (\n                <div\n                  key={i}\n                  style={{\n                    display: \"flex\",\n                    flexDirection: m.sender === username ? \"row-reverse\" : \"row\",\n                    marginBottom: 14,\n                  }}\n                >\n                  <div\n                    style={{\n                      maxWidth: \"80%\",\n                      background:\n                        m.sender === username\n                          ? \"linear-gradient(90deg, #22d3ee 60%, #818cf8 100%)\"\n                          : \"#23272f\",\n                      color: m.sender === username ? \"#fff\" : \"#818cf8\",\n                      padding: 14,\n                      borderRadius: 16,\n                      fontWeight: 600,\n                      fontSize: 15,\n                      boxShadow: m.sender === username\n                        ? \"0 2px 8px 0 rgba(34,211,238,0.10)\"\n                        : \"0 2px 8px 0 rgba(129,140,248,0.10)\",\n                    }}\n                  >\n                    <div style={{ fontSize: 15, fontWeight: 700 }}>\n                      {m.plaintext || \"[encrypted]\"}\n                    </div>\n                    <div style={{ fontSize: 11, color: \"#a1a1aa\", marginTop: 8 }}>\n                      {m.sender} • {new Date(m.ts || Date.now()).toLocaleTimeString()}\n                    </div>\n                  </div>\n                </div>\n              ))\n            ) : (\n              <div style={{ color: \"#818cf8\" }}>Select an object to see messages</div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}