{"ast":null,"code":"var _jsxFileName = \"D:\\\\projects\\\\BE MAJOR PROJECT Krutik\\\\client\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\n// App.js\nimport React, { useEffect, useRef, useState } from \"react\";\n\n// small helpers for base64 <-> ArrayBuffer\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction base64ToArrayBuffer(base64) {\n  const binary = window.atob(base64);\n  const len = binary.length;\n  const bytes = new Uint8Array(len);\n  for (let i = 0; i < len; i++) bytes[i] = binary.charCodeAt(i);\n  return bytes.buffer;\n}\nfunction arrayBufferToBase64(buffer) {\n  const bytes = new Uint8Array(buffer);\n  let binary = \"\";\n  for (let i = 0; i < bytes.byteLength; i++) binary += String.fromCharCode(bytes[i]);\n  return window.btoa(binary);\n}\nexport default function App() {\n  _s();\n  const videoRef = useRef(null);\n  const wsRef = useRef(null);\n  const [image, setImage] = useState(null);\n  const [detections, setDetections] = useState([]);\n  const [selectedObject, setSelectedObject] = useState(null);\n  const [messages, setMessages] = useState({}); // object_id -> [message]\n  const [objectKeys, setObjectKeys] = useState({}); // object_id -> base64 key\n  const [inputMsg, setInputMsg] = useState(\"\");\n  const userId = useRef(\"user_\" + Math.floor(Math.random() * 10000)).current;\n\n  // WebSocket connect\n  useEffect(() => {\n    const ws = new WebSocket(\"ws://localhost:7001/ws\");\n    ws.onopen = () => console.log(\"WS connected\");\n    ws.onmessage = evt => {\n      let data = null;\n      try {\n        data = JSON.parse(evt.data);\n      } catch (e) {\n        console.warn(\"Non-JSON WS msg ignored\", evt.data);\n        return;\n      }\n      if (data.type === \"info\") {\n        console.log(\"INFO:\", data.message);\n      } else if (data.type === \"detection_broadcast\") {\n        setImage(`data:image/jpeg;base64,${data.image}`);\n        setDetections(data.detections || []);\n        // update keys mapping (if provided)\n        if (data.keys) {\n          setObjectKeys(prev => ({\n            ...prev,\n            ...data.keys\n          }));\n        }\n      } else if (data.type === \"new_message\") {\n        const {\n          object_id,\n          message\n        } = data;\n        setMessages(prev => {\n          const arr = prev[object_id] ? [...prev[object_id]] : [];\n          arr.push(message);\n          return {\n            ...prev,\n            [object_id]: arr\n          };\n        });\n      }\n    };\n    wsRef.current = ws;\n    return () => ws.close();\n  }, []);\n\n  // Camera + frame sending (320x240 to reduce payload), 5 FPS\n  useEffect(() => {\n    let interval = null;\n    const start = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({\n          video: true\n        });\n        if (!videoRef.current) return;\n        videoRef.current.srcObject = stream;\n\n        // Wait for metadata loaded then play if needed\n        await new Promise(resolve => {\n          videoRef.current.onloadedmetadata = resolve;\n        });\n        try {\n          if (videoRef.current.paused) await videoRef.current.play();\n        } catch (err) {\n          console.warn(\"Video play interrupted:\", err);\n        }\n        interval = setInterval(() => {\n          if (!videoRef.current) return;\n          const canvas = document.createElement(\"canvas\");\n          canvas.width = 320; // smaller frame\n          canvas.height = 240;\n          const ctx = canvas.getContext(\"2d\");\n          ctx.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n          canvas.toBlob(async blob => {\n            if (!blob) return;\n            const fd = new FormData();\n            fd.append(\"file\", blob, \"frame.jpg\");\n            try {\n              await fetch(\"http://localhost:7001/detect\", {\n                method: \"POST\",\n                body: fd\n              });\n            } catch (err) {\n              console.warn(\"Frame send failed:\", err);\n            }\n          }, \"image/jpeg\", 0.7);\n        }, 200); // 5 FPS\n      } catch (err) {\n        console.error(\"Camera error:\", err);\n      }\n    };\n    start();\n    return () => {\n      if (interval) clearInterval(interval);\n      if (videoRef.current && videoRef.current.srcObject) {\n        const tracks = videoRef.current.srcObject.getTracks();\n        tracks.forEach(t => t.stop());\n      }\n    };\n  }, []);\n\n  // encrypt using subtle with provided base64 key\n  async function encryptForObject(object_id, plaintext) {\n    const key_b64 = objectKeys[object_id];\n    if (!key_b64) throw new Error(\"No key for object\");\n    const rawKey = base64ToArrayBuffer(key_b64);\n    const cryptoKey = await window.crypto.subtle.importKey(\"raw\", rawKey, {\n      name: \"AES-GCM\"\n    }, false, [\"encrypt\"]);\n    const iv = window.crypto.getRandomValues(new Uint8Array(12));\n    const enc = new TextEncoder().encode(plaintext);\n    const ct = await window.crypto.subtle.encrypt({\n      name: \"AES-GCM\",\n      iv\n    }, cryptoKey, enc);\n    return {\n      ciphertext: arrayBufferToBase64(ct),\n      iv: arrayBufferToBase64(iv.buffer)\n    };\n  }\n\n  // decrypt helper (for local preview; other clients will also decrypt)\n  async function decryptForObject(object_id, text_enc) {\n    try {\n      const key_b64 = objectKeys[object_id];\n      if (!key_b64) return \"[no key]\";\n      const rawKey = base64ToArrayBuffer(key_b64);\n      const cryptoKey = await window.crypto.subtle.importKey(\"raw\", rawKey, {\n        name: \"AES-GCM\"\n      }, false, [\"decrypt\"]);\n      const ivBuf = base64ToArrayBuffer(text_enc.iv);\n      const ctBuf = base64ToArrayBuffer(text_enc.ciphertext);\n      const plainBuf = await window.crypto.subtle.decrypt({\n        name: \"AES-GCM\",\n        iv: ivBuf\n      }, cryptoKey, ctBuf);\n      return new TextDecoder().decode(plainBuf);\n    } catch (err) {\n      console.warn(\"Decrypt failed\", err);\n      return \"[decryption failed]\";\n    }\n  }\n\n  // sending encrypted message\n  const sendMessage = async () => {\n    if (!selectedObject || !inputMsg) return;\n    try {\n      const text_enc = await encryptForObject(selectedObject, inputMsg);\n      const payload = {\n        type: \"send_message\",\n        object_id: selectedObject,\n        user_id: userId,\n        text_enc\n      };\n      wsRef.current.send(JSON.stringify(payload));\n\n      // locally append message (so sender sees it immediately, encrypted form)\n      setMessages(prev => {\n        const arr = prev[selectedObject] ? [...prev[selectedObject]] : [];\n        arr.push({\n          id: \"tmp-\" + Date.now(),\n          user_id: userId,\n          text_enc\n        });\n        return {\n          ...prev,\n          [selectedObject]: arr\n        };\n      });\n\n      // optionally decrypt locally for display (instant)\n      const plain = await decryptForObject(selectedObject, text_enc);\n      setMessages(prev => {\n        const arr = prev[selectedObject].map(m => m.id && m.id.startsWith(\"tmp-\") ? {\n          ...m,\n          plaintext: plain\n        } : m);\n        return {\n          ...prev,\n          [selectedObject]: arr\n        };\n      });\n    } catch (err) {\n      console.error(\"Send failed:\", err);\n    } finally {\n      setInputMsg(\"\");\n    }\n  };\n\n  // decrypt visible messages for UI when messages or keys update\n  useEffect(() => {\n    const decryptAllVisible = async () => {\n      if (!selectedObject) return;\n      const msgs = messages[selectedObject] || [];\n      const results = await Promise.all(msgs.map(async m => {\n        if (m.plaintext) return m;\n        if (m.text_enc) {\n          const p = await decryptForObject(selectedObject, m.text_enc);\n          return {\n            ...m,\n            plaintext: p\n          };\n        }\n        return {\n          ...m,\n          plaintext: m.text || \"\"\n        };\n      }));\n      setMessages(prev => ({\n        ...prev,\n        [selectedObject]: results\n      }));\n    };\n    decryptAllVisible();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [selectedObject, objectKeys]); // re-run when selectedObject or keys change\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: 16\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\uD83D\\uDCE1 Real-Time Object Messaging (demo)\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n      ref: videoRef,\n      style: {\n        display: \"none\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: \"relative\",\n        display: \"inline-block\"\n      },\n      children: [image ? /*#__PURE__*/_jsxDEV(\"img\", {\n        src: image,\n        alt: \"detection\",\n        style: {\n          width: 640,\n          height: 480\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: 640,\n          height: 480,\n          background: \"#eee\",\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\"\n        },\n        children: \"Waiting for detections...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 11\n      }, this), detections.map(d => {\n        const [x1, y1, x2, y2] = d.bbox;\n        const width = x2 - x1;\n        const height = y2 - y1;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          onClick: () => setSelectedObject(d.object_id),\n          style: {\n            position: \"absolute\",\n            left: x1,\n            top: y1,\n            width,\n            height,\n            border: selectedObject === d.object_id ? \"3px solid #00ff99\" : \"2px solid red\",\n            background: selectedObject === d.object_id ? \"rgba(0,255,153,0.12)\" : \"transparent\",\n            color: \"#fff\",\n            fontWeight: \"600\",\n            display: \"flex\",\n            alignItems: \"flex-start\",\n            justifyContent: \"flex-start\",\n            pointerEvents: \"auto\"\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              background: \"red\",\n              padding: \"2px 6px\",\n              fontSize: 12\n            },\n            children: d.class\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 15\n          }, this)\n        }, d.object_id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 13\n        }, this);\n      })]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: 12\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Selected object:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 9\n      }, this), \" \", selectedObject || \"None\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: 12,\n        display: \"flex\",\n        gap: 12\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: 400\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            height: 180,\n            overflowY: \"auto\",\n            border: \"1px solid #ccc\",\n            padding: 8\n          },\n          children: selectedObject && (messages[selectedObject] || []).length > 0 ? (messages[selectedObject] || []).map((m, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginBottom: 6\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: [m.user_id, \":\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 272,\n              columnNumber: 19\n            }, this), \" \", m.plaintext || \"[encrypted]\"]\n          }, m.id || i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 17\n          }, this)) : /*#__PURE__*/_jsxDEV(\"div\", {\n            children: \"No messages for this object yet\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: 8,\n            display: \"flex\",\n            gap: 8\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            value: inputMsg,\n            onChange: e => setInputMsg(e.target.value),\n            placeholder: selectedObject ? \"Type message...\" : \"Select an object first\",\n            style: {\n              flex: 1\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: sendMessage,\n            disabled: !selectedObject || !inputMsg,\n            children: \"Send\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: 220\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: \"600\",\n            marginBottom: 6\n          },\n          children: \"Object keys (demo)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            background: \"#fafafa\",\n            padding: 8,\n            border: \"1px solid #eee\",\n            height: 180,\n            overflowY: \"auto\"\n          },\n          children: [Object.keys(objectKeys).length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            children: \"No keys yet\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 54\n          }, this), Object.entries(objectKeys).map(([id, k]) => /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginBottom: 6\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: 12\n              },\n              children: id\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 299,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: 10,\n                color: \"#666\",\n                wordBreak: \"break-all\"\n              },\n              children: k\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 300,\n              columnNumber: 17\n            }, this)]\n          }, id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 298,\n            columnNumber: 15\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: 8,\n            fontSize: 12,\n            color: \"#666\"\n          },\n          children: \"Keys are included in detection broadcasts for demo only. In production, use secure key exchange.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 216,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"1va/zyyVVAI51kB0Q8I0pGMw86U=\");\n_c = App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useRef","useState","jsxDEV","_jsxDEV","base64ToArrayBuffer","base64","binary","window","atob","len","length","bytes","Uint8Array","i","charCodeAt","buffer","arrayBufferToBase64","byteLength","String","fromCharCode","btoa","App","_s","videoRef","wsRef","image","setImage","detections","setDetections","selectedObject","setSelectedObject","messages","setMessages","objectKeys","setObjectKeys","inputMsg","setInputMsg","userId","Math","floor","random","current","ws","WebSocket","onopen","console","log","onmessage","evt","data","JSON","parse","e","warn","type","message","keys","prev","object_id","arr","push","close","interval","start","stream","navigator","mediaDevices","getUserMedia","video","srcObject","Promise","resolve","onloadedmetadata","paused","play","err","setInterval","canvas","document","createElement","width","height","ctx","getContext","drawImage","toBlob","blob","fd","FormData","append","fetch","method","body","error","clearInterval","tracks","getTracks","forEach","t","stop","encryptForObject","plaintext","key_b64","Error","rawKey","cryptoKey","crypto","subtle","importKey","name","iv","getRandomValues","enc","TextEncoder","encode","ct","encrypt","ciphertext","decryptForObject","text_enc","ivBuf","ctBuf","plainBuf","decrypt","TextDecoder","decode","sendMessage","payload","user_id","send","stringify","id","Date","now","plain","map","m","startsWith","decryptAllVisible","msgs","results","all","p","text","style","padding","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","display","position","src","alt","background","alignItems","justifyContent","d","x1","y1","x2","y2","bbox","onClick","left","top","border","color","fontWeight","pointerEvents","fontSize","class","marginTop","gap","overflowY","marginBottom","value","onChange","target","placeholder","flex","disabled","Object","entries","k","wordBreak","_c","$RefreshReg$"],"sources":["D:/projects/BE MAJOR PROJECT Krutik/client/src/App.js"],"sourcesContent":["// App.js\nimport React, { useEffect, useRef, useState } from \"react\";\n\n// small helpers for base64 <-> ArrayBuffer\nfunction base64ToArrayBuffer(base64) {\n  const binary = window.atob(base64);\n  const len = binary.length;\n  const bytes = new Uint8Array(len);\n  for (let i = 0; i < len; i++) bytes[i] = binary.charCodeAt(i);\n  return bytes.buffer;\n}\nfunction arrayBufferToBase64(buffer) {\n  const bytes = new Uint8Array(buffer);\n  let binary = \"\";\n  for (let i = 0; i < bytes.byteLength; i++) binary += String.fromCharCode(bytes[i]);\n  return window.btoa(binary);\n}\n\nexport default function App() {\n  const videoRef = useRef(null);\n  const wsRef = useRef(null);\n\n  const [image, setImage] = useState(null);\n  const [detections, setDetections] = useState([]);\n  const [selectedObject, setSelectedObject] = useState(null);\n  const [messages, setMessages] = useState({}); // object_id -> [message]\n  const [objectKeys, setObjectKeys] = useState({}); // object_id -> base64 key\n  const [inputMsg, setInputMsg] = useState(\"\");\n  const userId = useRef(\"user_\" + Math.floor(Math.random() * 10000)).current;\n\n  // WebSocket connect\n  useEffect(() => {\n    const ws = new WebSocket(\"ws://localhost:7001/ws\");\n    ws.onopen = () => console.log(\"WS connected\");\n    ws.onmessage = (evt) => {\n      let data = null;\n      try {\n        data = JSON.parse(evt.data);\n      } catch (e) {\n        console.warn(\"Non-JSON WS msg ignored\", evt.data);\n        return;\n      }\n\n      if (data.type === \"info\") {\n        console.log(\"INFO:\", data.message);\n      } else if (data.type === \"detection_broadcast\") {\n        setImage(`data:image/jpeg;base64,${data.image}`);\n        setDetections(data.detections || []);\n        // update keys mapping (if provided)\n        if (data.keys) {\n          setObjectKeys((prev) => ({ ...prev, ...data.keys }));\n        }\n      } else if (data.type === \"new_message\") {\n        const { object_id, message } = data;\n        setMessages((prev) => {\n          const arr = prev[object_id] ? [...prev[object_id]] : [];\n          arr.push(message);\n          return { ...prev, [object_id]: arr };\n        });\n      }\n    };\n    wsRef.current = ws;\n    return () => ws.close();\n  }, []);\n\n  // Camera + frame sending (320x240 to reduce payload), 5 FPS\n  useEffect(() => {\n    let interval = null;\n    const start = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({ video: true });\n        if (!videoRef.current) return;\n        videoRef.current.srcObject = stream;\n\n        // Wait for metadata loaded then play if needed\n        await new Promise((resolve) => {\n          videoRef.current.onloadedmetadata = resolve;\n        });\n        try {\n          if (videoRef.current.paused) await videoRef.current.play();\n        } catch (err) {\n          console.warn(\"Video play interrupted:\", err);\n        }\n\n        interval = setInterval(() => {\n          if (!videoRef.current) return;\n          const canvas = document.createElement(\"canvas\");\n          canvas.width = 320; // smaller frame\n          canvas.height = 240;\n          const ctx = canvas.getContext(\"2d\");\n          ctx.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n          canvas.toBlob(\n            async (blob) => {\n              if (!blob) return;\n              const fd = new FormData();\n              fd.append(\"file\", blob, \"frame.jpg\");\n              try {\n                await fetch(\"http://localhost:7001/detect\", {\n                  method: \"POST\",\n                  body: fd,\n                });\n              } catch (err) {\n                console.warn(\"Frame send failed:\", err);\n              }\n            },\n            \"image/jpeg\",\n            0.7\n          );\n        }, 200); // 5 FPS\n      } catch (err) {\n        console.error(\"Camera error:\", err);\n      }\n    };\n    start();\n\n    return () => {\n      if (interval) clearInterval(interval);\n      if (videoRef.current && videoRef.current.srcObject) {\n        const tracks = videoRef.current.srcObject.getTracks();\n        tracks.forEach((t) => t.stop());\n      }\n    };\n  }, []);\n\n  // encrypt using subtle with provided base64 key\n  async function encryptForObject(object_id, plaintext) {\n    const key_b64 = objectKeys[object_id];\n    if (!key_b64) throw new Error(\"No key for object\");\n    const rawKey = base64ToArrayBuffer(key_b64);\n    const cryptoKey = await window.crypto.subtle.importKey(\"raw\", rawKey, { name: \"AES-GCM\" }, false, [\n      \"encrypt\",\n    ]);\n    const iv = window.crypto.getRandomValues(new Uint8Array(12));\n    const enc = new TextEncoder().encode(plaintext);\n    const ct = await window.crypto.subtle.encrypt({ name: \"AES-GCM\", iv }, cryptoKey, enc);\n    return {\n      ciphertext: arrayBufferToBase64(ct),\n      iv: arrayBufferToBase64(iv.buffer),\n    };\n  }\n\n  // decrypt helper (for local preview; other clients will also decrypt)\n  async function decryptForObject(object_id, text_enc) {\n    try {\n      const key_b64 = objectKeys[object_id];\n      if (!key_b64) return \"[no key]\";\n      const rawKey = base64ToArrayBuffer(key_b64);\n      const cryptoKey = await window.crypto.subtle.importKey(\"raw\", rawKey, { name: \"AES-GCM\" }, false, [\n        \"decrypt\",\n      ]);\n      const ivBuf = base64ToArrayBuffer(text_enc.iv);\n      const ctBuf = base64ToArrayBuffer(text_enc.ciphertext);\n      const plainBuf = await window.crypto.subtle.decrypt({ name: \"AES-GCM\", iv: ivBuf }, cryptoKey, ctBuf);\n      return new TextDecoder().decode(plainBuf);\n    } catch (err) {\n      console.warn(\"Decrypt failed\", err);\n      return \"[decryption failed]\";\n    }\n  }\n\n  // sending encrypted message\n  const sendMessage = async () => {\n    if (!selectedObject || !inputMsg) return;\n    try {\n      const text_enc = await encryptForObject(selectedObject, inputMsg);\n      const payload = {\n        type: \"send_message\",\n        object_id: selectedObject,\n        user_id: userId,\n        text_enc,\n      };\n      wsRef.current.send(JSON.stringify(payload));\n\n      // locally append message (so sender sees it immediately, encrypted form)\n      setMessages((prev) => {\n        const arr = prev[selectedObject] ? [...prev[selectedObject]] : [];\n        arr.push({ id: \"tmp-\" + Date.now(), user_id: userId, text_enc });\n        return { ...prev, [selectedObject]: arr };\n      });\n\n      // optionally decrypt locally for display (instant)\n      const plain = await decryptForObject(selectedObject, text_enc);\n      setMessages((prev) => {\n        const arr = prev[selectedObject].map((m) => (m.id && m.id.startsWith(\"tmp-\") ? { ...m, plaintext: plain } : m));\n        return { ...prev, [selectedObject]: arr };\n      });\n    } catch (err) {\n      console.error(\"Send failed:\", err);\n    } finally {\n      setInputMsg(\"\");\n    }\n  };\n\n  // decrypt visible messages for UI when messages or keys update\n  useEffect(() => {\n    const decryptAllVisible = async () => {\n      if (!selectedObject) return;\n      const msgs = messages[selectedObject] || [];\n      const results = await Promise.all(\n        msgs.map(async (m) => {\n          if (m.plaintext) return m;\n          if (m.text_enc) {\n            const p = await decryptForObject(selectedObject, m.text_enc);\n            return { ...m, plaintext: p };\n          }\n          return { ...m, plaintext: m.text || \"\" };\n        })\n      );\n      setMessages((prev) => ({ ...prev, [selectedObject]: results }));\n    };\n    decryptAllVisible();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [selectedObject, objectKeys]); // re-run when selectedObject or keys change\n\n  return (\n    <div style={{ padding: 16 }}>\n      <h2>ðŸ“¡ Real-Time Object Messaging (demo)</h2>\n\n      {/* hidden camera */}\n      <video ref={videoRef} style={{ display: \"none\" }} />\n\n      <div style={{ position: \"relative\", display: \"inline-block\" }}>\n        {image ? (\n          <img src={image} alt=\"detection\" style={{ width: 640, height: 480 }} />\n        ) : (\n          <div style={{ width: 640, height: 480, background: \"#eee\", display: \"flex\", alignItems: \"center\", justifyContent: \"center\" }}>\n            Waiting for detections...\n          </div>\n        )}\n\n        {/* overlay boxes */}\n        {detections.map((d) => {\n          const [x1, y1, x2, y2] = d.bbox;\n          const width = x2 - x1;\n          const height = y2 - y1;\n          return (\n            <div\n              key={d.object_id}\n              onClick={() => setSelectedObject(d.object_id)}\n              style={{\n                position: \"absolute\",\n                left: x1,\n                top: y1,\n                width,\n                height,\n                border: selectedObject === d.object_id ? \"3px solid #00ff99\" : \"2px solid red\",\n                background: selectedObject === d.object_id ? \"rgba(0,255,153,0.12)\" : \"transparent\",\n                color: \"#fff\",\n                fontWeight: \"600\",\n                display: \"flex\",\n                alignItems: \"flex-start\",\n                justifyContent: \"flex-start\",\n                pointerEvents: \"auto\",\n              }}\n            >\n              <div style={{ background: \"red\", padding: \"2px 6px\", fontSize: 12 }}>{d.class}</div>\n            </div>\n          );\n        })}\n      </div>\n\n      <div style={{ marginTop: 12 }}>\n        <strong>Selected object:</strong> {selectedObject || \"None\"}\n      </div>\n\n      <div style={{ marginTop: 12, display: \"flex\", gap: 12 }}>\n        <div style={{ width: 400 }}>\n          <div style={{ height: 180, overflowY: \"auto\", border: \"1px solid #ccc\", padding: 8 }}>\n            {selectedObject && (messages[selectedObject] || []).length > 0 ? (\n              (messages[selectedObject] || []).map((m, i) => (\n                <div key={m.id || i} style={{ marginBottom: 6 }}>\n                  <strong>{m.user_id}:</strong> {m.plaintext || \"[encrypted]\"}\n                </div>\n              ))\n            ) : (\n              <div>No messages for this object yet</div>\n            )}\n          </div>\n\n          <div style={{ marginTop: 8, display: \"flex\", gap: 8 }}>\n            <input\n              value={inputMsg}\n              onChange={(e) => setInputMsg(e.target.value)}\n              placeholder={selectedObject ? \"Type message...\" : \"Select an object first\"}\n              style={{ flex: 1 }}\n            />\n            <button onClick={sendMessage} disabled={!selectedObject || !inputMsg}>\n              Send\n            </button>\n          </div>\n        </div>\n\n        <div style={{ width: 220 }}>\n          <div style={{ fontWeight: \"600\", marginBottom: 6 }}>Object keys (demo)</div>\n          <div style={{ background: \"#fafafa\", padding: 8, border: \"1px solid #eee\", height: 180, overflowY: \"auto\" }}>\n            {Object.keys(objectKeys).length === 0 && <div>No keys yet</div>}\n            {Object.entries(objectKeys).map(([id, k]) => (\n              <div key={id} style={{ marginBottom: 6 }}>\n                <div style={{ fontSize: 12 }}>{id}</div>\n                <div style={{ fontSize: 10, color: \"#666\", wordBreak: \"break-all\" }}>{k}</div>\n              </div>\n            ))}\n          </div>\n          <div style={{ marginTop: 8, fontSize: 12, color: \"#666\" }}>\n            Keys are included in detection broadcasts for demo only. In production, use secure key exchange.\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}